# ng-base-project

To create Angular Base Project for library developments

## Usage

```bash
./initialise-lib.sh
```

## Description of the process

This shell script will execute several commands.

### Command : Function : check_nvm_and_node

First it will ensure that the computer on which you are running the script has nvm installed. Also ensure that you have the required node version (***20.11.1***).

**Note: The version is defined in a variable at the start of the shell script file: V_NODE**

### Command : Function : install_tools

This script is going to ensure that the right version (***17.3.3***) of Angular is installed, if not it will install it.

**Note: The version is defined in a variable at the start of the shell script file: V_ANGULAR_VERSION**

### Command : Function : create_lib_project : setup_create_ng_workspace

It will create an [Angular workspace](https://angular.io/guide/glossary#workspace).

```bash
ng new $V_PROJECT_NAME --create-application=false
```

***Warning: To ensure a fresh setup the folder is totally deleted.***

**Note: the folder name is defined in a variable at the start of the shell script file: V_PROJECT_NAME**

### Command : Function : create_lib_project : create_lib_and_showcase_projects

Within the workspace, it create one library and one showcase application (for library showcasing).

```bash
ng g library $library_name
ng g application $showcase_name --style=scss --ssr
```

### Command : Function : create_lib_project : copy_extra_files

This script will copy several initial files from the folder **sources** into the root of the workspace.

The files are: 
- LICENSE
- CODE_OF_CONDUCT.md
- CONTRIBUTING.md
- README.md

It will also create an empty CHANGELOG.md file into the workspace folder

### Command : Function : create_lib_project : setup_prettier

This part of the script will install the package [**prettier**](https://prettier.io) into the workspace. This is added into the package.json

**Prettier** is an opinionated code formatter. It [build and enforce](https://prettier.io/docs/en/why-prettier) a style guide for the code.

```bash
npm install --silent -D prettier
```

It will also create npm package runnable scripts:
- format:check:lib
- format:write:lib
- format:check:showcase
- format:write:showcase
- format:check:all
- format:write:all

**Note: It is not a [linter](https://prettier.io/docs/en/comparison).**

### Command : Function : create_lib_project : setup_eslint

This part of the script will install the packages for linting the code into the workspace. This is added into the package.json

```bash
ng add @angular-eslint/schematics --skip-confirmation
```

It will also create npm package runnable scripts:
- format:lint:lib
- format:lint:showcase
- format:lint

It will also copy an initial **eslintrc** configuration file at the root of the workspace.

### Command : Function : create_lib_project : setup_doctoc

This part of the script will install the package [**doctoc**](https://github.com/thlorenz/doctoc#readme) into the workspace. This is added into the package.json

```bash
npm install --silent -D doctoc
```

This package henerates table of contents for markdown files inside local git repository. Links are compatible with anchors generated by github or other sites.

This will be used to maintain the TOC of the project README.md

It will also create npm package runnable scripts:
- documentation:toc
- postbuild:lib

The later will ensure that the README.md located into the workspace is copied over the README.md of the library project.

**This will avoid out sync README.md file and allows to maintain one README.md for the whole project.**

### Command : Function : create_lib_project : setup_all_contributors

This part of the script will install the package [**all-contributors-cli**](https://github.com/all-contributors/cli#readme) into the workspace. This is added into the package.json

```bash
npm install --silent -D all-contributors-cli
```

When you have contributor to your code, it is a correct behaviour to refers to them and shout out about their contribution.

This package allows to maitain their list and integrate it into the README.md

It will also create npm package runnable scripts:
- contributors:add
- all-contributors generate

It will also copy an initial **all-contributorsrc** configuration file at the root of the workspace.

### Command : Function : create_lib_project : setup_husky_with_prettyquick_and_commitlint

The Husky package enhances your commits. It is deeply linked to[ GIT's hooks](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks)

``
...Git has a way to fire off custom scripts when certain important actions occur...
``

This part of the script install 3 packages into the workspace. They are added into the package.json

- [husky](https://typicode.github.io/husky/get-started.html)
- [pretty-quick](https://github.com/prettier/pretty-quick#readme)
- [commitlint](https://commitlint.js.org/guides/local-setup.html)

```bash
npm install --silent -D husky
npm install --silent -D pretty-quick
npm install --silent -D @commitlint/cli @commitlint/config-conventional
```
It will also create npm package runnable scripts:
- husky:init
- husky:prepare
- pretty-quick
- commitlint

It will also setup the husky configuration links to the git hooks. More precisely, it will prepare two hooks:
- pre-commit which will execute commitlint (which allow your team to add more semantic meaning to your git history)
- commit-msg which will execute pretty-quick (which runs Prettier on your changed files)

### Command : Function : create_lib_project : setup_github_actions

Copy initial CI/CD github actions configuration files at the root of the workspace:
- branch.yml
- release.yml

The **branch.yml** action file will be triggered when pushing to any branches of your repository except of the main branch. It is replaced to CI.

It will execute the following action:
- Checkout
- Setup Node
- Install dependencies
- Lint
- Test
- Coverage
- Build

The **release.yml** action file will be triggered on the push on the main branch. It will execute the same action as the **branch.yml** actions and additional step for the release.

It will execute the following action:
- Checkout
- Setup Node
- Install dependencies
- Lint
- Test
- Coverage
- Build
- Release

**Note: The release action will also publish the library NPMJS !!!**


## Warning

**Do not forget that you will have to adapt the script for your purpose**

**You will need [Github](https://github.com/) token and secret on your repository for the actions (branch and release)**

**You will need a token for publishing on [NPM](https://www.npmjs.com/) to be used in the GitHub actions (release)**

**You will need a account on [coveralls.io](https://coveralls.io/) linked to your Github repository**

## Resources

### Packages used

- [NVM](https://github.com/nvm-sh/nvm)
- [NodeJs](https://nodejs.org/en)
- [Angular CLI](https://github.com/angular/angular-cli)
- [Prettier](https://prettier.io/docs/en/install)
- [Angular ESLINT](https://github.com/angular-eslint/angular-eslint#readme)
- [DocToc](https://github.com/thlorenz/doctoc#readme)
- [All Contributors](https://github.com/all-contributors/cli#readme)
- [Husky](https://typicode.github.io/husky/get-started.html)
- [Pretty-Quick](https://github.com/prettier/pretty-quick#readme)
- [CommitLint](https://commitlint.js.org/guides/local-setup.html)
- [replace-json-property](https://github.com/kreuzerk/replace-json-property#readme)

### Extra services used

- [coveralls.io](https://coveralls.io/)
- [npmJs](https://www.npmjs.com/)